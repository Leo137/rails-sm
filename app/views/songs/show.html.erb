<p id="notice"><%= notice %></p>

<p>
  <strong>Name:</strong>
  <%= @song.name %>
</p>

<p>
  <strong>Server difficulty name:</strong>
  <%= @song.server_difficulty_name %>
</p>

<p>
  <strong>Server difficulty number:</strong>
  <%= @song.server_difficulty_number %>
</p>

<p>
  <strong>Server:</strong>
  <%= @song.server_id %>
</p>
</br>
<% if current_user != nil %>
	<% user_scores = current_user.user_scores.where("song_id =?", @song.id).order(server_migs_dp_obtained: :desc).take(5) %>
	<% if user_scores.count > 0 %>
	<h2>Your Top 5 Scores</h2>
		<table class="table">
		  <thead>
		    <tr>
		      <th>Match ID</th>
		      <th>Date</th>
		      <th>Percent</th>
		      <th>Marv-Perf-Great-Good-Bad-Miss</th>
		      <th>Mines Hit/Missed</th>
		      <th>Max Combo</th>
		      <th colspan="1"></th>
		    </tr>
		  </thead>
		  <tbody>
		    <% user_scores.each do |user_score| %>
		      <tr>
		        <td><%= user_score.server_id %></td>
		        <td><%= user_score.server_date %></td>
		        <td><%= user_score.server_percent %></td>
		        <td><%= user_score.server_marvelous %>-<%= user_score.server_perfects %>-<%= user_score.server_greats %>-<%= user_score.server_goods %>-<%= user_score.server_bads %>-<%= user_score.server_misses %></td>
		        <td><%= user_score.server_mines_hit %>/<%= user_score.server_mines_missed %></td>
		        <td><%= user_score.server_max_combo %></td>
		      </tr>
		    <% end %>
		  </tbody>
		</table>
	<% else %>
		<h2>No Scores yet</h2>
	<% end %>
<% end %>
<% if current_user != nil %>
	<%= form_tag(songs_update_score_path, method: "get") do %>
	  <%= hidden_field_tag(:userid, current_user.id) %>
	  <%= hidden_field_tag(:id, @song.id) %>
	  <%= submit_tag("Update scores", class: "btn btn-default") %>
	<% end %>
<% end %>

<%= link_to 'Edit', edit_song_path(@song) %> |
<%= link_to 'Back', songs_path %>
